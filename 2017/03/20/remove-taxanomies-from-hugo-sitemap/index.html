<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="Content-Security-Policy" content="default-src 'self' https:; script-src 'self' 'unsafe-eval' 'unsafe-inline' data: https:; img-src 'self' data: https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https:; object-src 'self'"/><meta name="viewport" content="width=device-width,initial-scale=1"><title>Remove taxanomies from Hugo sitemap</title><meta name="msvalidate.01" content="009F12474AB330989749B979B5868A7F"/><meta name="google-site-verification" content="in8GfCIv-CYlwD5AxO0jVMlrUy1s42a_-cxlOWdv4U0"/><meta name="yandex-verification" content="c29e9c1084b24e1d"/><meta name="description" content="Most blogging systems offer a way to create user-defined groupings of content called taxanomies. I do not want them showing up on search engines."/><meta name="author" content="Leow Kah Man"/><link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192"/><link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"/><link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"/><link rel="canonical" href="https://www.leowkahman.com/2017/03/20/remove-taxanomies-from-hugo-sitemap/"><link href="" rel="alternate" type="application/rss+xml" title="Leow Kah Man - Tech Blog"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" integrity="sha256-Zd1icfZ72UBmsId/mUcagrmN7IN5Qkrvh75ICHIQVTk=" crossorigin="anonymous"/><link rel="stylesheet" href="/css/custom.css?v=1.0.0"/><style id="antiClickjack">body{display:none!important}</style><script>if(self===top){var antiClickjack=document.getElementById("antiClickjack");antiClickjack.parentNode.removeChild(antiClickjack)}else top.location=self.location</script><script>function redirectToCorrectDomainIfRequired(){for(var o=["www.leowkahman.com","localhost"],e=0;e<o.length;e++)if(window.location.hostname==o[e])return;window.location="https://www.leowkahman.com"+window.location.pathname}redirectToCorrectDomainIfRequired()</script></head><body><nav class="navbar navbar-default navbar-static-top"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="/">Leow Kah Man - Tech Blog</a></div><div id="navbar" class="navbar-collapse collapse"><ul class="nav navbar-nav"></ul><ul class="nav navbar-nav navbar-right"><li><a href="/about/">About</a></li><li><a href="/contact/">Contact</a></li></ul></div></div></nav><div class="container"><div class="row"><div class="col-sm-12"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8585963436723502" data-ad-slot="7600784826" data-ad-format="auto"></ins></div></div><div class="row"><div class="col-sm-8 blog-main"><div class="row"><div class="blog-main blog-post"><h1 class="blog-post-title">Remove taxanomies from Hugo sitemap</h1><p class="blog-post-meta"><i class="fa fa-calendar"></i> Published: 20 March 2017 &nbsp;|&nbsp; <i class="fa fa-folder"></i> <a href="https://www.leowkahman.com/categories/web">Web</a></p><ul class="list-inline share" style="margin-top:15px;margin-left:0"><li class="facebook-share"><a target="_blank" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.leowkahman.com%2f2017%2f03%2f20%2fremove-taxanomies-from-hugo-sitemap%2f"><i class="fa fa-facebook fa-lg"></i> Facebook</a></li><li class="googleplus-share"><a target="_blank" href="https://plus.google.com/share?url=https%3a%2f%2fwww.leowkahman.com%2f2017%2f03%2f20%2fremove-taxanomies-from-hugo-sitemap%2f"><i class="fa fa-google-plus fa-lg"></i> Google+</a></li><li class="twitter-share"><a target="_blank" href="https://twitter.com/share?url=https%3a%2f%2fwww.leowkahman.com%2f2017%2f03%2f20%2fremove-taxanomies-from-hugo-sitemap%2f&amp;text=Remove%20taxanomies%20from%20Hugo%20sitemap"><i class="fa fa-twitter fa-lg"></i> Twitter</a></li><li class="reddit-share"><a target="_blank" href="http://reddit.com/submit?url=https%3a%2f%2fwww.leowkahman.com%2f2017%2f03%2f20%2fremove-taxanomies-from-hugo-sitemap%2f&amp;title=Remove%20taxanomies%20from%20Hugo%20sitemap"><i class="fa fa-reddit fa-lg"></i> Reddit</a></li><li class="linkedin-share"><a target="_blank" href="http://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fwww.leowkahman.com%2f2017%2f03%2f20%2fremove-taxanomies-from-hugo-sitemap%2f"><i class="fa fa-linkedin fa-lg"></i> LinkedIn</a></li></ul><p>Most blogging systems offer a way to create user-defined groupings of content called taxanomies. While I like the feature, I do not want them showing in search engines.</p><p></p><h2 id="update">Update</h2><p><em>2017-09-10: After migrating to use GitLab CI for building and publishing, I now</em> <em><a href="/2017/09/10/gitlab-ci-remove-priority-zero-from-hugo-sitemap">use XMLStarlet in GitLab CI</a></em> <em>to achieve the same outcome.</em></p><h2 id="motivation">Motivation</h2><p>When I was using WordPress, it was easy to find a plugin that can omit taxanomies from appearing in sitemap. With Hugo, I could not find a way to disable these from showing up on search engines. I also found that in some cases, the taxanomy links were ranked higher than the actual content page. Since my posts and pages are already indexed, there is no value in having taxanomies indexed so I had to remove them. One of the ways is by adding a post-build step.</p><h2 id="before-adding-post-build-step">Before adding post-build step</h2><p>My batch file for generating <code>public</code> output folder on Hugo was:</p><pre><code class="language-bash">rd /s /q public
md public
hugo.exe
</code></pre><p>The above cleans the output folder, recreates and finally publishes into it. You may not like the idea of deleting and recreating the public folder. The first two lines are optional.</p><h2 id="adding-post-build-step">Adding post-build step</h2><p>I coded a simple Powershell script that cleanses the <code>sitemap.xml</code> file of taxanomies.</p><pre><code class="language-powershell">[xml]$xml = Get-Content public\sitemap.xml

$ns = New-Object System.Xml.XmlNamespaceManager($xml.NameTable)
$ns.AddNamespace(&quot;ns&quot;, $xml.DocumentElement.NamespaceURI)

$xpathSelectCriterion = &quot;//ns:url[contains(ns:loc, '/categories/') or contains(ns:loc, '/tags/')]&quot;

$node = $xml.SelectSingleNode($xpathSelectCriterion, $ns)
while ($node -ne $null) {
    $node.ParentNode.RemoveChild($node)
    $node = $xml.SelectSingleNode($xpathSelectCriterion, $ns)
}

$xml.save(&quot;public\sitemap.xml&quot;)
</code></pre><p>Then added a line at the end of my batch file to call the script above:</p><pre><code class="language-bash">rd /s /q public
md public
hugo.exe
powershell -noexit &quot;&amp; &quot;&quot;.\clean-sitemap.ps1&quot;&quot;&quot;
</code></pre><h3 id="why-powershell">Why Powershell</h3><p>I tried and found Windows batch commands too cumbersome. In the end I needed to achieve the results required using the shortest possible time and using an interpreted language so that I do not have to upload binary files into source control.</p><h2 id="robots-txt">Robots.txt</h2><p>You need to tell search bots that crawling <code>categories</code> and <code>tags</code> taxanomies are disallowed.</p><pre><code class="language-text">User-agent: *
Disallow: /categories/
Disallow: /tags/
Sitemap: https://www.leowkahman.com/sitemap.xml
</code></pre><p>Remember to point the <code>Sitemap</code> line to your <code>sitemap.xml</code>.</p><h2 id="results">Results</h2><p>I had to wait a few days for Google to recrawl and purge the taxanomies. To verify that Google has removed the taxanomies from search result, search for <code>site:www.leowkahman.com</code>. They should disappear. You need to replace the domain with yours of course.</p><ul class="list-inline tags" style="margin-left:0"><li class="btn btn-primary"><a href="https://www.leowkahman.com/tags/hugo">Hugo</a></li><li class="btn btn-primary"><a href="https://www.leowkahman.com/tags/sitemap">sitemap</a></li></ul></div></div><div class="row"><h4>Support Me</h4><p>If this post helped you, would you buy me a cup of tea/coffee?</p><a title="PayPal" href="https://www.paypal.me/leowkahman/12"><i class="fa fa-2x fa-paypal"></i> </a>&nbsp;&nbsp; <a title="Bitcoin" href="bitcoin:14vH7vDj7eyvvc7mxCkrgTx2HUntpeKhAn?amount=0.001&amp;label=Tech%20Blog"><i class="fa fa-2x fa-btc"></i> </a><a title="Bitcoin QR code" href="/images/bitcoin.png"><i class="fa fa-2x fa-qrcode"></i></a></div><div class="blog-post"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8585963436723502" data-ad-slot="8937917223" data-ad-format="auto"></ins></div><div class="row"><div id="disqus_thread"></div><script>!function(){if("localhost"!=window.location.hostname){var e=document.createElement("script");e.type="text/javascript",e.async=!0;e.src="https://leowkahman.disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}}()</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div><div class="col-sm-4 blog-sidebar"><div class="sidebar-module"><script>!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://cse.google.com/cse.js?cx=partner-pub-8585963436723502:5716828028";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><gcse:search></gcse:search></div><div class="sidebar-module"><h4>Recent Posts</h4><ul class="list-unstyled posts-recent"><li><a href="https://www.leowkahman.com/2017/12/22/cruising-on-quantum-of-the-seas/">Cruising on Quantum of the Seas</a></li><li><a href="https://www.leowkahman.com/2017/11/12/using-amazon-echo-outside-us/">Using Amazon Echo outside US</a></li><li><a href="https://www.leowkahman.com/2017/10/12/cwe-316-storing-secure-strings-in-dotnet-securestring/">CWE-316 storing secure strings in .NET SecureString</a></li><li><a href="https://www.leowkahman.com/2017/10/02/byod-ci-cd-build-machine-to-run-pipelines-using-docker/">BYOD CI/CD build machine to run pipelines using Docker</a></li><li><a href="https://www.leowkahman.com/2017/09/23/checklist-for-switching-from-windows-to-linux/">Checklist for switching from Windows to Linux</a></li></ul></div><div class="sidebar-module"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8585963436723502" data-ad-slot="6069940020" data-ad-format="auto"></ins></div><div class="sidebar-module"><h4>Categories</h4><ul class="list-unstyled posts-recent"><li><a href="https://www.leowkahman.com/categories/web/">web</a></li><li><a href="https://www.leowkahman.com/categories/network/">network</a></li><li><a href="https://www.leowkahman.com/categories/software/">software</a></li><li><a href="https://www.leowkahman.com/categories/hardware/">hardware</a></li><li><a href="https://www.leowkahman.com/categories/cloud/">cloud</a></li></ul></div></div></div></div><footer class="blog-footer"><div class="container"><div class="row"><div class="col-sm-8 col-xs-6"><ul class="list-inline links"><li><a href="https://status.leowkahman.com/">Uptime</a></li></ul></div><div class="col-sm-4 col-xs-6"><ul class="list-inline"><li><a target="_blank" href="/index.xml"><i class="fa fa-rss fa-lg"></i></a></li><li><a target="_blank" href="https://stackexchange.com/users/6729082/leow-kah-man"><i class="fa fa-stack-exchange fa-lg"></i></a></li><li><a target="_blank" href="https://github.com/kmleow"><i class="fa fa-github fa-lg"></i></a></li><li><a target="_blank" href="https://www.linkedin.com/in/kmleow"><i class="fa fa-linkedin fa-lg"></i></a></li><li><a target="_blank" href="https://www.facebook.com/LeowKahMan"><i class="fa fa-facebook fa-lg"></i></a></li></ul></div></div></div><div class="container"><div class="col-sm-12 row"><p>Except as otherwise noted, the content of this page is licensed under the <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>,<br/>code samples are licensed under the <a href="https://tldrlegal.com/license/mit-license">MIT License</a>.</p></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha256-Daf8GuI2eLKHJlOWLRR/zRy9Clqcj4TUSumbxYH9kGI=" crossorigin="anonymous"></script><script src="/js/custom.js?v=1.0.1"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>[].forEach.call(document.querySelectorAll(".adsbygoogle"),function(){(adsbygoogle=window.adsbygoogle||[]).push({})})</script><script>!function(e,a,t,n,c,g,o){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,g=a.createElement("script"),o=a.getElementsByTagName("script")[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",o.parentNode.insertBefore(g,o)}(window,document),ga("create","UA-61838818-1","auto"),ga("send","pageview"),ga("set","forceSSL",!0)</script></body></html>