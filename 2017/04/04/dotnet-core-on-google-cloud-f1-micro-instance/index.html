<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="Content-Security-Policy" content="default-src 'self' https:; script-src 'self' 'unsafe-eval' 'unsafe-inline' data: https:; img-src 'self' data: https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https:; object-src 'self'"/><meta name="viewport" content="width=device-width,initial-scale=1"><title>.NET Core on Google Cloud f1-micro instance</title><meta name="msvalidate.01" content="009F12474AB330989749B979B5868A7F"/><meta name="google-site-verification" content="in8GfCIv-CYlwD5AxO0jVMlrUy1s42a_-cxlOWdv4U0"/><meta name="yandex-verification" content="c29e9c1084b24e1d"/><meta name="description" content="Simple Hello World test on Google Cloud Platform f1-micro instance and also ran OpenSSL speed tests"/><meta name="author" content="Leow Kah Man"/><link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192"/><link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"/><link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"/><link rel="canonical" href="https://www.leowkahman.com/2017/04/04/dotnet-core-on-google-cloud-f1-micro-instance/"><link href="" rel="alternate" type="application/rss+xml" title="Leow Kah Man - Tech Blog"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" integrity="sha256-Zd1icfZ72UBmsId/mUcagrmN7IN5Qkrvh75ICHIQVTk=" crossorigin="anonymous"/><link rel="stylesheet" href="/css/custom.css?v=1.0.0"/><style id="antiClickjack">body{display:none!important}</style><script>if(self===top){var antiClickjack=document.getElementById("antiClickjack");antiClickjack.parentNode.removeChild(antiClickjack)}else top.location=self.location</script><script>function redirectToCorrectDomainIfRequired(){for(var o=["www.leowkahman.com","localhost"],e=0;e<o.length;e++)if(window.location.hostname==o[e])return;window.location="https://www.leowkahman.com"+window.location.pathname}redirectToCorrectDomainIfRequired()</script></head><body><nav class="navbar navbar-default navbar-static-top"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="/">Leow Kah Man - Tech Blog</a></div><div id="navbar" class="navbar-collapse collapse"><ul class="nav navbar-nav"></ul><ul class="nav navbar-nav navbar-right"><li><a href="/about/">About</a></li><li><a href="/contact/">Contact</a></li></ul></div></div></nav><div class="container"><div class="row"><div class="col-sm-12"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8585963436723502" data-ad-slot="7600784826" data-ad-format="auto"></ins></div></div><div class="row"><div class="col-sm-8 blog-main"><div class="row"><div class="blog-main blog-post"><h1 class="blog-post-title">.NET Core on Google Cloud f1-micro instance</h1><p class="blog-post-meta"><i class="fa fa-calendar"></i> Published: 4 April 2017 &nbsp;|&nbsp; <i class="fa fa-calendar-check-o"></i> Last updated: 4 April 2017 &nbsp;|&nbsp; <i class="fa fa-folder"></i> <a href="https://www.leowkahman.com/categories/cloud">Cloud</a></p><ul class="list-inline share" style="margin-top:15px;margin-left:0"><li class="facebook-share"><a target="_blank" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.leowkahman.com%2f2017%2f04%2f04%2fdotnet-core-on-google-cloud-f1-micro-instance%2f"><i class="fa fa-facebook fa-lg"></i> Facebook</a></li><li class="googleplus-share"><a target="_blank" href="https://plus.google.com/share?url=https%3a%2f%2fwww.leowkahman.com%2f2017%2f04%2f04%2fdotnet-core-on-google-cloud-f1-micro-instance%2f"><i class="fa fa-google-plus fa-lg"></i> Google+</a></li><li class="twitter-share"><a target="_blank" href="https://twitter.com/share?url=https%3a%2f%2fwww.leowkahman.com%2f2017%2f04%2f04%2fdotnet-core-on-google-cloud-f1-micro-instance%2f&amp;text=.NET%20Core%20on%20Google%20Cloud%20f1-micro%20instance"><i class="fa fa-twitter fa-lg"></i> Twitter</a></li><li class="reddit-share"><a target="_blank" href="http://reddit.com/submit?url=https%3a%2f%2fwww.leowkahman.com%2f2017%2f04%2f04%2fdotnet-core-on-google-cloud-f1-micro-instance%2f&amp;title=.NET%20Core%20on%20Google%20Cloud%20f1-micro%20instance"><i class="fa fa-reddit fa-lg"></i> Reddit</a></li><li class="linkedin-share"><a target="_blank" href="http://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fwww.leowkahman.com%2f2017%2f04%2f04%2fdotnet-core-on-google-cloud-f1-micro-instance%2f"><i class="fa fa-linkedin fa-lg"></i> LinkedIn</a></li></ul><p>Given that .NET Core is capable of running on Linux, I decided to try running a simple Hello World test on Google Cloud Platform f1-micro instance and also ran OpenSSL speed tests.</p><p></p><h2 id="motivation">Motivation</h2><p>I have been working on a hobby project written in .NET Core and will be hosting it on Google Cloud Platform VM eventually. Aside from the running simple Hello World example, considering I ran <a href="/2016/02/21/openssl-benchmark-raspberry-vs-nas-vs-archer-c7/">OpenSSL speed test on some of my Raspberry Pi 2, NAS and router</a>, I wanted to know how much faster or slower the f1-micro is relative to them.</p><h2 id="installing-net-core">Installing .NET Core</h2><p>I provisioned a f1-micro instance with Ubuntu Linux 16.04 LTS operating system on 10GB standard disk. You can pick <a href="https://cloud.google.com/compute/docs/images">whichever</a> as long as it is <a href="https://www.microsoft.com/net/core#linuxubuntu">supported by Microsoft</a>.</p><p>I ran the instructions as per the guide on Microsoft page:</p><pre><code class="language-bash">sudo sh -c 'echo &quot;deb [arch=amd64] https://apt-mo.trafficmanager.net/repos/dotnet-release/ xenial main&quot; &gt; /etc/apt/sources.list.d/dotnetdev.list'
sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 417A0893
sudo apt-get update
sudo apt-get install dotnet-dev-1.0.1
dotnet new console -o hwapp
cd hwapp
</code></pre><p>The output of interest were:</p><pre><code class="language-text">Decompressing 100% 10518 ms
Expanding 100% 60763 ms
Content generation time: 733.5919 ms
</code></pre><p><em>Note: f1-micro is burstable. From Google Console, I observed a 200% spike in</em> <em>CPU usage. The same level of spikes were observed in subsequent benchmarks below.</em></p><p>In contrast, my Intel i7 Q740 laptop with SSD achieved the following which I am (quite certain) did not take advantage of multiple cores:</p><pre><code class="language-text">Decompressing 100% 8895 ms
Expanding 100% 57911 ms
Content generation time: 86.7835 ms
</code></pre><p>Interestingly, almost equal performance except the content generation time which was more disk intensive.</p><h2 id="running-net-hello-world-and-timing-it">Running .NET Hello World and timing it</h2><p>I ran the following on f1-micro:</p><pre><code class="language-bash">dotnet restore
echo `date +%s%3N` &amp;&amp; dotnet run &amp;&amp; echo `date +%s%3N`
</code></pre><p>The output with numbers in miliseconds:</p><pre><code class="language-text">1491231632032
Hello World!
1491231634465
</code></pre><p>Roughly 2.4 seconds to run.</p><p>Then, I ran similar test on my laptop with the following output:</p><pre><code class="language-text"> 0:14:24.83
Hello World!
 0:14:27.09
</code></pre><p>Roughly 2.2 seconds to run.</p><h2 id="openssl-benchmark-on-f1-micro">OpenSSL benchmark on f1-micro</h2><p>I ran a few times. Below were the best observed.</p><p>RSA speed test with command line: <code>openssl speed rsa</code></p><table><thead><tr><th align="right">RSA</th><th align="right">sign/s</th><th align="right">verify/s</th></tr></thead><tbody><tr><td align="right">512</td><td align="right">18018.8</td><td align="right">304004.6</td></tr><tr><td align="right">1024</td><td align="right">8491.0</td><td align="right">26482.4</td></tr><tr><td align="right">2048</td><td align="right">257.2</td><td align="right">8664.1</td></tr><tr><td align="right">4096</td><td align="right">39.5</td><td align="right">2573.9</td></tr></tbody></table><p>AES speed test with command line: <code>openssl speed aes</code></p><table><thead><tr><th align="right">AES-CBC</th><th align="right">16 bytes</th><th align="right">64 bytes</th><th align="right">256 bytes</th><th align="right">1024 bytes</th><th align="right">8192 bytes</th></tr></thead><tbody><tr><td align="right">128</td><td align="right">73542.90k</td><td align="right">63012.76k</td><td align="right">63044.69k</td><td align="right">64832.17k</td><td align="right">72859.48k</td></tr><tr><td align="right">192</td><td align="right">53858.26k</td><td align="right">72861.08k</td><td align="right">67095.81k</td><td align="right">59642.20k</td><td align="right">63984.98k</td></tr><tr><td align="right">256</td><td align="right">31454.13k</td><td align="right">15389.46k</td><td align="right">12743.85k</td><td align="right">12026.01k</td><td align="right">16037.21k</td></tr></tbody></table><p>See <a href="/2016/02/21/openssl-benchmark-raspberry-vs-nas-vs-archer-c7/">comparison against my other devices</a>.</p><h2 id="cpu-usage-of-f1-micro">CPU usage of f1-micro</h2><p><a href="/images/2017/04/google-cloud-f1-micro-cpu-usage.png"><img src="/images/2017/04/google-cloud-f1-micro-cpu-usage.png" alt="Google Cloud f1-micro CPU usage"/></a></p><p>As I mentioned earlier, f1-micro is burstable so take the performance numbers that I have reported above with a grain of salt. The bursts may come handy when you get short spikes in traffic.</p><h2 id="openssl-benchmark-on-my-laptop">OpenSSL benchmark on my laptop</h2><p>In order to perform multi-core OpenSSL test, I had to use <a href="https://msdn.microsoft.com/en-us/commandline/wsl/install_guide">Windows Subsystem for Linux</a>. The Windows OpenSSL binaries do not support multi-core speed test at time of writing this article.</p><p>RSA speed test with command line: <code>openssl speed rsa -multi 4</code></p><table><thead><tr><th align="right">RSA</th><th align="right">sign/s</th><th align="right">verify/s</th></tr></thead><tbody><tr><td align="right">512</td><td align="right">24922.4</td><td align="right">348484.8</td></tr><tr><td align="right">1024</td><td align="right">7523.2</td><td align="right">122159.1</td></tr><tr><td align="right">2048</td><td align="right">1052.3</td><td align="right">35556.3</td></tr><tr><td align="right">4096</td><td align="right">141.3</td><td align="right">9169.2</td></tr></tbody></table><p>Interestingly, my laptop was slower than the f1-micro for 1024-bit RSA sign/s test.</p><p>AES speed test with command line: <code>openssl speed aes -multi 4</code></p><table><thead><tr><th align="right">AES-CBC</th><th align="right">16 bytes</th><th align="right">64 bytes</th><th align="right">256 bytes</th><th align="right">1024 bytes</th><th align="right">8192 bytes</th></tr></thead><tbody><tr><td align="right">128</td><td align="right">205552.27k</td><td align="right">216593.13k</td><td align="right">226590.63k</td><td align="right">224839.34k</td><td align="right">217838.93k</td></tr><tr><td align="right">192</td><td align="right">168102.19k</td><td align="right">172801.09k</td><td align="right">174397.18k</td><td align="right">184247.98k</td><td align="right">187921.75k</td></tr><tr><td align="right">256</td><td align="right">149979.53k</td><td align="right">158063.40k</td><td align="right">126086.14k</td><td align="right">132667.05k</td><td align="right">159730.35k</td></tr></tbody></table><h2 id="conclusion">Conclusion</h2><p>Provisioning a new f1-micro Linux machine on Google Cloud was very easy. Installation of .NET Core was very quick and OpenSSL benchmark numbers gave me a rough indication of its performance. I could develop applications on my laptop and <a href="https://www.howtogeek.com/121775/how-to-force-windows-applications-to-use-a-specific-cpu/">force it to run on a single core</a> to get a rough indicator of the f1-micro&rsquo;s throughput.</p><ul class="list-inline tags" style="margin-left:0"><li class="btn btn-primary"><a href="https://www.leowkahman.com/tags/cloud">cloud</a></li><li class="btn btn-primary"><a href="https://www.leowkahman.com/tags/dotnet">dotnet</a></li><li class="btn btn-primary"><a href="https://www.leowkahman.com/tags/google">Google</a></li></ul></div></div><div class="row"><h4>Support Me</h4><p>If this post helped you, would you buy me a cup of tea/coffee?</p><a href="https://www.paypal.me/leowkahman/12"><i class="fa fa-3x fa-cc-paypal"></i> </a>&nbsp;&nbsp; <a href="#btc" onclick='return document.getElementById("btc").style.display="block",!1'><i class="fa fa-3x fa-btc"></i> </a><span id="btc" style="display:none"><a href="bitcoin:14vH7vDj7eyvvc7mxCkrgTx2HUntpeKhAn?amount=0.001&amp;label=Tech%20Blog"><img src="/images/bitcoin.png"> 14vH7vDj7eyvvc7mxCkrgTx2HUntpeKhAn</a></span></div><div class="blog-post"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8585963436723502" data-ad-slot="8937917223" data-ad-format="auto"></ins></div><div class="row"><div id="disqus_thread"></div><script>!function(){if("localhost"!=window.location.hostname){var e=document.createElement("script");e.type="text/javascript",e.async=!0;e.src="https://leowkahman.disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}}()</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div><div class="col-sm-4 blog-sidebar"><div class="sidebar-module"><script>!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://cse.google.com/cse.js?cx=partner-pub-8585963436723502:5716828028";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><gcse:search></gcse:search></div><div class="sidebar-module"><h4>Recent Posts</h4><ul class="list-unstyled posts-recent"><li><a href="https://www.leowkahman.com/2017/09/23/checklist-for-switching-from-windows-to-linux/">Checklist for switching from Windows to Linux</a></li><li><a href="https://www.leowkahman.com/2017/09/11/enforce-safe-search-on-google-youtube-bing/">Enforce Safe Search on Google, YouTube, Bing</a></li><li><a href="https://www.leowkahman.com/2017/09/10/gitlab-ci-remove-priority-zero-from-hugo-sitemap/">GitLab CI remove priority zero from Hugo sitemap</a></li><li><a href="https://www.leowkahman.com/2017/09/09/gitlab-ci-push-output-to-github/">GitLab CI push output to GitHub</a></li><li><a href="https://www.leowkahman.com/2017/09/05/tm-streamyx-router-wifi-security/">TM Streamyx Router Wi-Fi Security</a></li></ul></div><div class="sidebar-module"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8585963436723502" data-ad-slot="6069940020" data-ad-format="auto"></ins></div><div class="sidebar-module"><h4>Categories</h4><ul class="list-unstyled posts-recent"><li><a href="https://www.leowkahman.com/categories/web/">web</a></li><li><a href="https://www.leowkahman.com/categories/network/">network</a></li><li><a href="https://www.leowkahman.com/categories/software/">software</a></li><li><a href="https://www.leowkahman.com/categories/hardware/">hardware</a></li><li><a href="https://www.leowkahman.com/categories/cloud/">cloud</a></li></ul></div></div></div></div><footer class="blog-footer"><div class="container"><div class="row"><div class="col-sm-8 col-xs-6"><ul class="list-inline links"><li><a href="https://status.leowkahman.com/">Uptime</a></li></ul></div><div class="col-sm-4 col-xs-6"><ul class="list-inline"><li><a target="_blank" href="/index.xml"><i class="fa fa-rss fa-lg"></i></a></li><li><a target="_blank" href="https://stackexchange.com/users/6729082/leow-kah-man"><i class="fa fa-stack-exchange fa-lg"></i></a></li><li><a target="_blank" href="https://github.com/kmleow"><i class="fa fa-github fa-lg"></i></a></li><li><a target="_blank" href="https://www.linkedin.com/in/kmleow"><i class="fa fa-linkedin fa-lg"></i></a></li><li><a target="_blank" href="https://www.facebook.com/LeowKahMan"><i class="fa fa-facebook fa-lg"></i></a></li></ul></div></div></div><div class="container"><div class="col-sm-12 row"><p>Except as otherwise noted, the content of this page is licensed under the <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>,<br/>code samples are licensed under the <a href="https://tldrlegal.com/license/mit-license">MIT License</a>.</p></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha256-Daf8GuI2eLKHJlOWLRR/zRy9Clqcj4TUSumbxYH9kGI=" crossorigin="anonymous"></script><script src="/js/custom.js?v=1.0.1"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>[].forEach.call(document.querySelectorAll(".adsbygoogle"),function(){(adsbygoogle=window.adsbygoogle||[]).push({})})</script><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src="//www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-61838818-1","auto"),ga("send","pageview"),ga("set","forceSSL",!0)</script></body></html>