<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Get notified via IFTTT or Pushbullet when OpenWRT router has started</title><meta name="msvalidate.01" content="009F12474AB330989749B979B5868A7F"/><meta name="google-site-verification" content="in8GfCIv-CYlwD5AxO0jVMlrUy1s42a_-cxlOWdv4U0"/><meta name="yandex-verification" content="c29e9c1084b24e1d"/><meta name="description" content="Using IFTTT&#39;s Maker channel, I could setup a Web Request receiver then configured my OpenWRT router to post to the receiver on startup"/><meta name="author" content="Leow Kah Man"/><link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192"/><link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"/><link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"/><link rel="canonical" href="https://www.leowkahman.com/2016/07/31/get-notified-via-ifttt-pushbullet-when-openwrt-router-has-started/"><link href="" rel="alternate" type="application/rss+xml" title="Leow Kah Man - Tech Blog"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/vs.min.css" integrity="sha256-iGs2TpBtdfGr1FIgzGyO4CKAD1+2QaDswtMmJwDtHAs=" crossorigin="anonymous"/><link rel="stylesheet" href="/css/custom.css?v=1.0.0"/><style id="antiClickjack">body{display:none!important}</style><script>if(self===top){var antiClickjack=document.getElementById("antiClickjack");antiClickjack.parentNode.removeChild(antiClickjack)}else top.location=self.location</script><script>function redirectToCorrectDomainIfRequired(){for(var o=["www.leowkahman.com","localhost"],e=0;e<o.length;e++)if(window.location.hostname==o[e])return;window.location="https://www.leowkahman.com"+window.location.pathname}redirectToCorrectDomainIfRequired()</script></head><body><nav class="navbar navbar-default navbar-static-top"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="/">Leow Kah Man - Tech Blog</a></div><div id="navbar" class="navbar-collapse collapse"><ul class="nav navbar-nav"></ul><ul class="nav navbar-nav navbar-right"><li><a href="/about/">About</a></li><li><a href="/contact/">Contact</a></li></ul></div></div></nav><div class="container"><div class="row"><div class="col-sm-8 blog-main"><div class="row"><div class="blog-main blog-post"><h1 class="blog-post-title">Get notified via IFTTT or Pushbullet when OpenWRT router has started</h1><p class="blog-post-meta"><i class="fa fa-calendar"></i> Published: 31 July 2016 &nbsp;|&nbsp; <i class="fa fa-calendar-check-o"></i> Last updated: 23 July 2018 &nbsp;|&nbsp; <i class="fa fa-folder"></i> <a href="https://www.leowkahman.com/categories/network">Network</a></p><ul class="list-inline share" style="margin-top:15px;margin-left:0"><li class="facebook-share"><a target="_blank" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.leowkahman.com%2f2016%2f07%2f31%2fget-notified-via-ifttt-pushbullet-when-openwrt-router-has-started%2f"><i class="fa fa-facebook fa-lg"></i> Facebook</a></li><li class="twitter-share"><a target="_blank" href="https://twitter.com/share?url=https%3a%2f%2fwww.leowkahman.com%2f2016%2f07%2f31%2fget-notified-via-ifttt-pushbullet-when-openwrt-router-has-started%2f&amp;text=Get%20notified%20via%20IFTTT%20or%20Pushbullet%20when%20OpenWRT%20router%20has%20started"><i class="fa fa-twitter fa-lg"></i> Twitter</a></li><li class="reddit-share"><a target="_blank" href="http://reddit.com/submit?url=https%3a%2f%2fwww.leowkahman.com%2f2016%2f07%2f31%2fget-notified-via-ifttt-pushbullet-when-openwrt-router-has-started%2f&amp;title=Get%20notified%20via%20IFTTT%20or%20Pushbullet%20when%20OpenWRT%20router%20has%20started"><i class="fa fa-reddit fa-lg"></i> Reddit</a></li><li class="linkedin-share"><a target="_blank" href="http://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fwww.leowkahman.com%2f2016%2f07%2f31%2fget-notified-via-ifttt-pushbullet-when-openwrt-router-has-started%2f"><i class="fa fa-linkedin fa-lg"></i> LinkedIn</a></li></ul><p>Using IFTTT&rsquo;s Maker channel, I could setup a Web Request receiver or if you prefer a simpler method, you could use Pushbullet. Then I configured my OpenWRT router to post to the receiver on startup.</p><h2 id="motivation">Motivation</h2><p>I wanted to know how often my router reboots. Using OpenWRT router, I could configure my router to do something on startup. i.e. calling a web endpoint. With that, I could post a message to IFTTT via its <a href="https://ifttt.com/maker">Maker</a> channel or post a message to Pushbullet API. I will explain the setup for both but and the choice is yours.</p><h2 id="ifttt-maker">IFTTT Maker</h2><p>If you have not heard of <a href="https://ifttt.com">IFTTT</a> before. IFTTT stands for If-This-Then-That. In a nutshell, it chains a condition to an action.</p><p>The IFTTT Maker channel enables the creation of a HTTPS Web Request receiver. This receiver is secured by an authentication key so that others cannot post to it. Multiple receivers can be created with each for capturing a specific event. Each event can optionally include up to 3 values.</p><p>I am assuming that you can figure out how to signup for an account IFTTT and activate the Maker channel. Then you may want to follow these simple steps:</p><ol><li>Click on <code>My Recipes</code>.</li><li>Click on <code>Create a Recipe</code>.</li><li>Choose Trigger Channel: <code>Maker</code>.</li><li>Click on <code>Receive a web request</code>.</li><li>Give a meaningful Event Name: <code>OpenWRT_started</code>. I recommend replacing spaces with underscore or else you will need to substitute space with <code>%20</code> later.</li><li>Choose Action Channel: <code>IF Notifications</code>.</li><li>In the Notification field, enter: <code>{{EventName}} {{Value1}}</code>.</li></ol><p>To make a web request from OpenWRT, you must have <code>curl</code> and <code>ca-certificates</code> installed.</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">opkg update
opkg install curl
opkg install ca-certificates
</code></pre></div><p>Once you have the above installed, try out the Maker Web Request endpoint:</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl -X POST -H <span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span> -d <span style="color:#e6db74">&#39;{&#34;value1&#34;:&#34;openwrt&#34;,&#34;value2&#34;:&#34;&#39;</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>/sbin/ifconfig pppoe-wan | grep <span style="color:#e6db74">&#39;inet addr&#39;</span> | cut -d: -f2 | awk <span style="color:#e6db74">&#39;{print $1}&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">&#39;&#34;}&#39;</span> https://maker.ifttt.com/trigger/OpenWRT_started/with/key/&lt;key&gt;
</code></pre></div><p>This command sends 2 values to IFTTT. The first is a constant string, &ldquo;openwrt&rdquo;. The second is the current WAN IP address. My WAN interface is named <code>pppoe-wan</code>. You will need to substitute the name. Also, be sure to replace <code>&lt;key&gt;</code> with your Maker key.</p><p>The output from the command above is:</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Congratulations! You&#39;ve fired the OpenWRT_started event
</code></pre></div><p>Check the Recipe Log and you should see <code>Personal Recipe triggered</code>. You should be receiving a notification pushed to your phone in a minute if you have <code>IF by IFTTT</code> installed.</p><h2 id="pushbullet">Pushbullet</h2><p>If you prefer <a href="https://www.pushbullet.com">Pushbullet</a>, go to <code>Settings &gt; Account &gt; Access Tokens</code>. Click on <code>Create Access Token</code>. Copy that token.</p><p>To post a message to Pushbullet from OpenWRT, you will need <code>curl</code> and <code>ca-certificates</code> installed. Scroll up for the instructions.</p><p>Then post a message to Pushbullet using:</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl --header <span style="color:#e6db74">&#39;Access-Token: &lt;Access_Token&gt;&#39;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>     --header <span style="color:#e6db74">&#39;Content-Type: application/json&#39;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>     --data-binary <span style="color:#e6db74">&#39;{&#34;body&#34;:&#34;&#39;</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>/sbin/ifconfig pppoe-wan | grep <span style="color:#e6db74">&#39;inet addr&#39;</span> | cut -d: -f2 | awk <span style="color:#e6db74">&#39;{print $1}&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">&#39;&#34;,&#34;title&#34;:&#34;OpenWRT started&#34;,&#34;type&#34;:&#34;note&#34;}&#39;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>     --request POST <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>     https://api.pushbullet.com/v2/pushes
</code></pre></div><p>Be sure to replace <code>&lt;Access_Token&gt;</code> with your access token created earlier.</p><p>You should be receiving a notification via Pushbullet almost immediately.</p><h2 id="calling-iftttpushbullet-on-openwrt-startup">Calling IFTTT/Pushbullet on OpenWRT startup</h2><p>Via OpenWRT LuCI, navigate to <code>System &gt; Startup</code>. Scroll to the bottom and add the the full <code>curl ...</code> line into <code>Local Startup</code> placing it above <code>exit 0</code>. You may want to include a delay until internet connection is available before calling this command. i.e.:</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Wait until Internet connection is available</span>
<span style="color:#66d9ef">for</span> i in <span style="color:#f92672">{</span>1..60<span style="color:#f92672">}</span>; <span style="color:#66d9ef">do</span> ping -c1 -W1 8.8.8.8 &amp;&gt; /dev/null <span style="color:#f92672">&amp;&amp;</span> break; <span style="color:#66d9ef">done</span>

<span style="color:#75715e"># Replace this line with the full curl command to IFTTT/Pushbullet</span>
curl ...

exit <span style="color:#ae81ff">0</span>
</code></pre></div><p>Finally, reboot your router to test it out.</p><ul class="list-inline tags" style="margin-left:0"><li class="btn btn-primary"><a href="https://www.leowkahman.com/tags/ifttt">IFTTT</a></li><li class="btn btn-primary"><a href="https://www.leowkahman.com/tags/pushbullet">Pushbullet</a></li><li class="btn btn-primary"><a href="https://www.leowkahman.com/tags/openwrt">OpenWRT</a></li></ul></div></div><div class="row"><div id="disqus_thread"></div><script>!function(){if("localhost"!=window.location.hostname){var e=document.createElement("script");e.type="text/javascript",e.async=!0;e.src="https://leowkahman.disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}}()</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div><div class="col-sm-4 blog-sidebar"><div class="sidebar-module"><script>!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://cse.google.com/cse.js?cx=partner-pub-8585963436723502:5716828028";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><gcse:search></gcse:search></div><div class="sidebar-module"><h4>Recent Posts</h4><ul class="list-unstyled posts-recent"><li><a href="https://www.leowkahman.com/2020/02/01/speedtest-openwrt-with-flow-offloading/">Speedtest OpenWRT with flow offloading</a></li><li><a href="https://www.leowkahman.com/2019/02/06/ultrawide-monitor-on-linux/">Ultrawide monitor on Linux</a></li><li><a href="https://www.leowkahman.com/2019/02/03/switched-from-ubuntu-to-linux-mint/">Switched from Ubuntu to Linux Mint</a></li><li><a href="https://www.leowkahman.com/2018/08/11/reduce-internet-lag-on-openwrt/">Reduce internet lag on OpenWRT</a></li><li><a href="https://www.leowkahman.com/2018/05/29/workaround-to-wifi-issues-on-openwrt-lede/">Workaround to Wi-Fi issues on OpenWRT LEDE</a></li></ul></div><div class="sidebar-module"><h4>Categories</h4><ul class="list-unstyled posts-recent"><li><a href="https://www.leowkahman.com/categories/software/">software</a></li><li><a href="https://www.leowkahman.com/categories/web/">web</a></li><li><a href="https://www.leowkahman.com/categories/network/">network</a></li><li><a href="https://www.leowkahman.com/categories/hardware/">hardware</a></li><li><a href="https://www.leowkahman.com/categories/programming/">programming</a></li></ul></div></div></div></div><footer class="blog-footer"><div class="container"><div class="row"><div class="col-sm-8 col-xs-6"><ul class="list-inline links"><li><a href="/privacy-policy/">Privacy Policy</a></li></ul></div><div class="col-sm-4 col-xs-6"><ul class="list-inline"><li><a target="_blank" href="/index.xml"><i class="fa fa-rss fa-lg"></i></a></li><li><a target="_blank" href="https://stackexchange.com/users/6729082/leow-kah-man"><i class="fa fa-stack-exchange fa-lg"></i></a></li><li><a target="_blank" href="https://github.com/kmleow"><i class="fa fa-github fa-lg"></i></a></li><li><a target="_blank" href="https://twitter.com/kmleow"><i class="fa fa-twitter fa-lg"></i></a></li><li><a target="_blank" href="https://www.linkedin.com/in/kmleow"><i class="fa fa-linkedin fa-lg"></i></a></li><li><a target="_blank" href="https://www.facebook.com/LeowKahMan"><i class="fa fa-facebook fa-lg"></i></a></li><li><a target="_blank" href="https://www.paypal.me/leowkahman/5usd"><i class="fa fa-paypal fa-lg"></i></a></li></ul></div></div></div><div class="container"><div class="col-sm-12 row"><p>Except as otherwise noted, the content of this page is licensed under the <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>,<br/>code samples are licensed under the <a href="https://tldrlegal.com/license/mit-license">MIT License</a>. Third-party product names and logos may be the trademarks of their respective owners.</p></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js" integrity="sha256-MAgcygDRahs+F/Nk5Vz387whB4kSK9NXlDN3w58LLq0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha256-Daf8GuI2eLKHJlOWLRR/zRy9Clqcj4TUSumbxYH9kGI=" crossorigin="anonymous"></script><script src="/js/custom.js?v=1.0.1"></script><script data-ad-client="ca-pub-8585963436723502" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-61838818-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-61838818-1")</script></body></html>